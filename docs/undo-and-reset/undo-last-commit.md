# ЁЯФД Undo Last Commit (Git ржП рж╢рзЗрж╖ ржХржорж┐ржЯ ржмрж╛рждрж┐рж▓ ржХрж░рж╛)

## ЁЯУМ ржЙржжрзНржжрзЗрж╢рзНржп:

рж╢рзЗрж╖ ржпрзЗржЗ ржХржорж┐ржЯржЯрж╛ ржХрж░рзЗржЫрж┐, рж╕рзЗржЯрж╛ рж╣рзЯрждрзЛ:

* ржнрзБрж▓ commit message,
* ржнрзБрж▓ ржлрж╛ржЗрж▓,
* ржирж╛ ржЪрж╛ржУрзЯрж╛ ржХрзЛржирзЛ ржХрзЛржб,
* staging ржмрж╛ working directory ржарж┐ржХ ржирж╛ ржерж╛ржХрж╛ ржЕржмрж╕рзНржерж╛рзЯ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

ржПржЗ ржнрзБрж▓ржЯрж╛ рж╢рзБржзрж░рж╛рждрзЗ ржЪрж╛ржЗ, рждрж╛ржЗ **рж╢рзЗрж╖ ржХржорж┐ржЯржЯрж┐ undo** ржХрж░рждрзЗ ржЪрж╛ржЗред

## ЁЯзн рждрж┐ржиржнрж╛ржмрзЗ рж╢рзЗрж╖ ржХржорж┐ржЯ Undo ржХрж░рж╛ ржпрж╛рзЯ:

## тЬЕ рзз. рж╢рзБржзрзБ рж╢рзЗрж╖ ржХржорж┐ржЯ ржорзБржЫрзЗ ржлрзЗрж▓рзЛ, ржХрж┐ржирзНрждрзБ ржХрж╛ржЬ (ржлрж╛ржЗрж▓ ржЪрзЗржЮрзНржЬ) рж░рзЗржЦрзЗ ржжрж╛ржУ

ржЕрж░рзНржерж╛рзО ржЖржкржирж┐ ржпрзЗржЗ ржХржорж┐ржЯ ржХрж░рзЗржЫрзЗржи, рж╕рзЗржЯрж┐ ржорзБржЫрзЗ ржпрж╛ржмрзЗ, ржХрж┐ржирзНрждрзБ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ unstaged ржЕржмрж╕рзНржерж╛рзЯ ржерж╛ржХржмрзЗред

```bash
git reset --soft HEAD~1
```

### ЁЯОп ржЙржжрж╛рж╣рж░ржг:

```bash
git commit -m "Oops, ржнрзБрж▓ ржХрж░рж▓рж╛ржо"
git reset --soft HEAD~1
```

ржПржЦржи ржЖржкржирж┐ `git status` ржЪрж╛рж▓рж╛рж▓рзЗ ржжрзЗржЦржмрзЗржи ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ staging ржП ржЖржЫрзЗред ржЖржкржирж┐ ржЪрж╛ржЗрж▓рзЗ ржЖржмрж╛рж░ ржарж┐ржХ ржХрж░рзЗ ржХржорж┐ржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

## тЬЕ рзи. рж╢рзЗрж╖ ржХржорж┐ржЯ ржорзБржЫрзЗ ржлрзЗрж▓рзЛ ржПржмржВ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛржУ unstaged ржХрж░рзЛ

ржПржЯрж╛ ржХрж░рж▓рзЗ рж╢рзЗрж╖ ржХржорж┐ржЯ ржмрж╛рждрж┐рж▓ рж╣ржмрзЗ ржПржмржВ ржЖржкржирж╛рж░ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ рж╕рзНржЯрзЗржЬрж┐ржВ (staging) ржерзЗржХрзЗ рж╕рж░рж┐рзЯрзЗ working directory-рждрзЗ ржпрж╛ржмрзЗред

```bash
git reset --mixed HEAD~1
```

**NB:** ржПржЯрж╛ рж╕ржмржЪрзЗрзЯрзЗ ржХржоржиржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред

### ЁЯОп ржЙржжрж╛рж╣рж░ржг:

```bash
git reset --mixed HEAD~1
```

> ржПржЦржи `git status` ржжрзЗржЦрж╛ржмрзЗ: modified files ржЖржЫрзЗ ржХрж┐ржирзНрждрзБ рждрж╛рж░рж╛ staged ржирж╛ред

## тЬЕ рзй. рж╕ржмржХрж┐ржЫрзБ ржмрж╛рждрж┐рж▓ ржХрж░рзЗ ржлрж╛ржЗрж▓ржУ ржЖржЧрзЗрж░ ржЕржмрж╕рзНржерж╛рзЯ ржирж┐рзЯрзЗ ржпрж╛ржУ (hard reset)

**рж╕рждрж░рзНржХржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи!** ржХрж╛рж░ржг ржЖржкржирж╛рж░ рж╢рзЗрж╖ ржХржорж┐ржЯрзЗрж░ рж╕ржм ржХрж╛ржЬ ржЪрж▓рзЗ ржпрж╛ржмрзЗред

```bash
git reset --hard HEAD~1
```

### ЁЯОп ржЙржжрж╛рж╣рж░ржг:

```bash
git reset --hard HEAD~1
```

> ржПржЯрж╛ ржХрж░рж▓рзЗ ржлрж╛ржЗрж▓рзЗрж░ ржЪрзЗржЮрзНржЬржЯрж╛ржУ ржмрж╛рждрж┐рж▓ рж╣рзЯрзЗ ржпрж╛ржмрзЗред ржЕрж░рзНржерж╛рзО ржЖржкржирж┐ ржпрзЗржЯрж╛ ржХржорж┐ржЯ ржХрж░рзЗржЫрж┐рж▓рзЗржи, рж╕рзЗржЯрж┐ ржУ рждрж╛рж░ рж╕ржм ржлрж╛ржЗрж▓рзЗрж░ ржкрж░рж┐ржмрж░рзНрждржи ржЙржнрзЯржЗ ржЪрж▓рзЗ ржпрж╛ржмрзЗред

## ЁЯзк ржХржЦржи ржХрзЛржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи?

| ржЙржжрзНржжрзЗрж╢рзНржп                               | ржХржорж╛ржирзНржб                     |
| -------------------------------------- | -------------------------- |
| рж╢рзБржзрзБ ржХржорж┐ржЯ ржорзБржЫрждрзЗ ржЪрж╛ржи, ржХрж╛ржЬ рж░рж╛ржЦрждрзЗ ржЪрж╛ржи     | `git reset --soft HEAD~1`  |
| ржХржорж┐ржЯ ржорзБржЫрждрзЗ ржЪрж╛ржи, ржХрж╛ржЬ unstaged рж░рж╛ржЦрждрзЗ ржЪрж╛ржи | `git reset --mixed HEAD~1` |
| ржХржорж┐ржЯ + ржХрж╛ржЬ ржжрзБржЗржЯрж╛ржЗ ржорзБржЫрждрзЗ ржЪрж╛ржи            | `git reset --hard HEAD~1`  |


## тЬЕ Reword (рж╢рзБржзрзБ ржХржорж┐ржЯ ржорзЗрж╕рзЗржЬ ржмржжрж▓рж╛ржирзЛ)

```bash
git commit --amend
```

### ЁЯОп ржЙржжрж╛рж╣рж░ржг:

```bash
git commit -m "Bug fixed"
# ржнрзБрж▓ ржорзЗрж╕рзЗржЬ! ржПржЦржи ржарж┐ржХ ржХрж░ржмрзЛ
git commit --amend
```

> ржПржЯрж┐ ржПржХржЯрж┐ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХржЯрж┐ржн ржПржбрж┐ржЯрж░ ржЦрзБрж▓ржмрзЗ, ржпрзЗржЦрж╛ржирзЗ ржЖржкржирж┐ ржорзЗрж╕рзЗржЬржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред

## тЬЕ рж╢рзЗрж╖ ржХржорж┐ржЯ undo ржХрж░рзЗ ржЖржмрж╛рж░ ржирждрзБржи ржХржорж┐ржЯ

```bash
git reset --soft HEAD~1
git add .
git commit -m "рж╕ржарж┐ржХ ржХржорж┐ржЯ ржорзЗрж╕рзЗржЬ ржжрж┐рзЯрзЗ ржЖржмрж╛рж░ ржХрж░рж▓рж╛ржо"
```

## тЬЕ ржпржжрж┐ ржЖржкржирж┐ рж░рж┐ржорзЛржЯрзЗ push ржХрж░рзЗ ржлрзЗрж▓рзЗржи?

рждрж╛рж╣рж▓рзЗ `--force` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржарж┐ржХ ржХрж░рждрзЗ рж╣ржмрзЗред

```bash
git reset --soft HEAD~1
git commit -m "рж╕ржВрж╢рзЛржзрж┐ржд ржХржорж┐ржЯ"
git push --force
```

тЪая╕П рж╕рждрж░рзНржХрждрж╛:

> ржЯрж┐ржорзЗ ржХрж╛ржЬ ржХрж░рж▓рзЗ `--force` ржмрзНржпржмрж╣рж╛рж░ ржЖржЧрзЗ ржЯрж┐ржоржорзЗржЯржжрзЗрж░ рж╕ржЩрзНржЧрзЗ ржЖрж▓рзЛржЪржирж╛ ржХрж░рзЗ ржХрж░рзБржиред

## тЬЕ ржХржорж┐ржЯ ржмрж╛рждрж┐рж▓ ржХрж░рзЗ stash ржП рж░рж╛ржЦрждрзЗ ржЪрж╛ржи?

```bash
git reset --mixed HEAD~1
git stash
```

> ржПржЦржи рж╕ржм ржХрж╛ржЬ stash рж╣рзЯрзЗ ржЧрзЗрж▓, ржкрж░рзЗ `git stash apply` ржжрж┐рзЯрзЗ ржлрзЗрж░ржд ржЖржирждрзЗ ржкрж╛рж░ржмрзЗржиред

## ЁЯза HEAD\~1 ржорж╛ржирзЗ ржХрзА?

`HEAD` рж╣рж▓рзЛ ржмрж░рзНрждржорж╛ржи ржХржорж┐ржЯред `HEAD~1` ржорж╛ржирзЗ ржПржХ ржзрж╛ржк ржЖржЧрзЗрж░ ржХржорж┐ржЯред

## тЬЕ ржЖрж░рзЗржХржЯрж┐ ржЙржжрж╛рж╣рж░ржг тАФ ржПржХрж╕рж╛ржерзЗ рзиржЯрж╛ ржХржорж┐ржЯ undo

```bash
git reset --soft HEAD~2
```

> рж╢рзЗрж╖ рзиржЯрж┐ ржХржорж┐ржЯ ржмрж╛рждрж┐рж▓ рж╣ржмрзЗ, ржХрж┐ржирзНрждрзБ ржХрж╛ржЬ ржерж╛ржХржмрзЗред

## тЬЕ рж╢рзЗрж╖ ржХржорж┐ржЯрзЗ ржнрзБрж▓ ржХрж░рзЗ sensitive рждржерзНржп (ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб) ржЪрж▓рзЗ ржЧрзЗржЫрзЗ?

```bash
git reset --hard HEAD~1
git push origin main --force
```

> ржПрж░ ржкрж░ `.gitignore` ржЖржкржбрзЗржЯ ржХрж░рзЗ ржПржмржВ credentials rotate ржХрж░рзЗ ржлрзЗрж▓рзБржиред

## ЁЯФЪ ржЙржкрж╕ржВрж╣рж╛рж░

Git-ржП ржнрзБрж▓ ржХржорж┐ржЯ undo ржХрж░рж╛ ржЦрзБржмржЗ ржжрж░ржХрж╛рж░рж┐ ржУ ржкрзНрж░рж╛рзЯ ржкрзНрж░рждрж┐ржжрж┐ржирзЗрж░ ржкрзНрж░рзЯрзЛржЬржиред ржЖржкржирж┐ ржпржжрж┐ ржирж┐ржЪрзЗрж░ ржЬрж┐ржирж┐рж╕ржЧрзБрж▓рзЛ ржоржирзЗ рж░рж╛ржЦрзЗржи, рждрж╛рж╣рж▓рзЗ ржжрзНрж░рзБржд рж╕ржорж╛ржзрж╛ржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржитАФ

| ржХрж┐ ржХрж░рждрзЗ ржЪрж╛ржи                    | ржХрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи |
| ------------------------------ | ---------------- |
| рж╢рзБржзрзБ ржХржорж┐ржЯ ржмрж╛рждрж┐рж▓, ржХрж╛ржЬ рж░рж╛ржЦржмрзЗржи    | `--soft`         |
| ржХржорж┐ржЯ + рж╕рзНржЯрзЗржЬ ржмрж╛рждрж┐рж▓, ржХрж╛ржЬ рж░рж╛ржЦржмрзЗржи | `--mixed`        |
| ржХржорж┐ржЯ + ржлрж╛ржЗрж▓ ржЪрзЗржЮрзНржЬ ржмрж╛ржж ржжрж┐рждрзЗ ржЪрж╛ржи | `--hard`         |
| рж╢рзБржзрзБ ржорзЗрж╕рзЗржЬ ржмржжрж▓рж╛рждрзЗ ржЪрж╛ржи          | `--amend`        |

